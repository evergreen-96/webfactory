{% extends "base.html" %}

{% block content %}
    <div class="container-md mt-2">
        <form method="post" onsubmit="return validateForm()">
            <div class="form-group">
                <label>Выберите станок:</label>
                {% for machine in users_machines %}
                    <div class="form-check">
                        <input type="radio" id="machine{{ machine.id }}" name="selected_machine"
                               value="{{ machine.id }}"
                               class="form-check-input" {% if machine.is_stucked %}disabled{% endif %}>
                        <label for="machine{{ machine.id }}" class="form-check-label">
                            {{ machine }}
                            {% if machine.is_stucked %}
                                <span class="text-muted">(недоступно)</span>
                            {% endif %}
                        </label>
                    </div>
                {% endfor %}
            </div>
            {% csrf_token %}
            <button id="start-button" class="btn btn-primary btn-block w-100">Начать новую деталь</button>
        </form>
    </div>

    <div class="container-md mt-2">
        <form method="post">
            {% csrf_token %}
            <button name="endShift" id="end-button" class="btn btn-danger btn-block w-100">Закончить смену</button>
        </form>
    </div>

    {% include "bugreport_form.html" %}

    <script>
        function validateForm() {
            var selectedMachine = document.querySelector('input[name="selected_machine"]:checked');

            if (!selectedMachine) {
                alert('Выберите станок перед продолжением!');
                return false; // Отменить отправку формы
            }
            return true; // Разрешить отправку формы
        }
    </script>
{% endblock %}
