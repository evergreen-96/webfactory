<div class="modal fade" id="bugReportModal" tabindex="-1" role="dialog"
     aria-labelledby="bugReportModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="bugReportModalLabel">Сообщить о
                    проблеме</h5>
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Закрыть">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="" method="post" id="reportForm">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="bugDescription">Описание проблемы</label>
                        <textarea class="form-control" id="bugDescription"
                                  name="bug_description" rows="4"
                                  required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary"
                            id="justReportButton">Сообщить о
                        проблеме
                    </button>
                    <button type="submit" class="btn btn-danger"
                            id="stopWorkButton">Сообщить о проблеме и
                        приостановить работу
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<button id="reportBtn" type="button" class="btn btn-success w-100">Ошибка!
</button>


<div class="modal fade" id="successModal" tabindex="-1" role="dialog"
     aria-labelledby="successModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="successModalLabel">Успешно
                    отправлено</h5>
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Закрыть">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Ваш отчет был успешно отправлен.
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var errorModal = new bootstrap.Modal(document.getElementById('bugReportModal'));

        document.getElementById('reportBtn').addEventListener('click', function () {
            errorModal.show();
        });

        document.getElementById('justReportButton').addEventListener('click', function () {
            event.preventDefault();
            var formData = new FormData(document.getElementById('reportForm'));
            var url = '/report/';  // URL для обработки формы на сервере
            var xhr = new XMLHttpRequest();
            xhr.open('POST', url, true);
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4) {
                    errorModal.hide();  // Скрыть модальное окно после успешной отправки

                    // Вывести уведомление о успешной отправке
                    var successModal = new bootstrap.Modal(document.getElementById('successModal'));
                    successModal.show();
                }
            };
            xhr.send(formData);
        });

        document.getElementById('stopWorkButton').addEventListener('click', function () {
            event.preventDefault();
            var formData = new FormData(document.getElementById('reportForm'));
            var url = '/report/';  // URL для обработки формы на сервере
            var xhr = new XMLHttpRequest();
            xhr.open('POST', url, true);
            xhr.send(formData);
            console.log('отправлено и остановлена работа');
        });
    });
</script>

